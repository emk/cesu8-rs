<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="rustdoc">
    <meta name="description" content="API documentation for the Rust `cesu8` crate.">
    <meta name="keywords" content="rust, rustlang, rust-lang, cesu8">

    <title>cesu8 - Rust</title>

    <link rel="stylesheet" type="text/css" href="../rustdoc.css">
    <link rel="stylesheet" type="text/css" href="../main.css">
    

    
    
</head>
<body class="rustdoc">
    <!--[if lte IE 8]>
    <div class="warning">
        This old browser is unsupported and will most likely display funky
        things.
    </div>
    <![endif]-->

    

    <nav class="sidebar">
        
        <p class='location'></p><script>window.sidebarCurrent = {name: 'cesu8', ty: 'mod', relpath: '../'};</script>
    </nav>

    <nav class="sub">
        <form class="search-form js-only">
            <div class="search-container">
                <input class="search-input" name="search"
                       autocomplete="off"
                       placeholder="Click or press ‚ÄòS‚Äô to search, ‚Äò?‚Äô for more options‚Ä¶"
                       type="search">
            </div>
        </form>
    </nav>

    <section id='main' class="content mod">
<h1 class='fqn'><span class='in-band'>Crate <a class='mod' href=''>cesu8</a></span><span class='out-of-band'><span id='render-detail'>
                   <a id="toggle-all-docs" href="javascript:void(0)" title="collapse all docs">
                       [<span class='inner'>&#x2212;</span>]
                   </a>
               </span><a id='src-0' class='srclink' href='../src/cesu8/src/lib.rs.html#11-453' title='goto source code'>[src]</a></span></h1>
<div class='docblock'><p>A simple library implementing the <a href="http://www.unicode.org/reports/tr26/tr26-2.html">CESU-8 compatibility encoding
scheme</a>.  This is a
non-standard variant of UTF-8 that is used internally by some systems
that need to represent UTF-16 data as 8-bit characters.  Yes, this is
ugly.</p>

<p>Use of this encoding is discouraged by the Unicode Consortium.  It&#39;s OK
for working with existing internal APIs, but it should not be used for
transmitting or storing data.</p>

<pre class='rust rust-example-rendered'>
<span class='kw'>use</span> <span class='ident'>std</span>::<span class='ident'>borrow</span>::<span class='ident'>Cow</span>;
<span class='kw'>use</span> <span class='ident'>cesu8</span>::{<span class='ident'>from_cesu8</span>, <span class='ident'>to_cesu8</span>};

<span class='comment'>// 16-bit Unicode characters are the same in UTF-8 and CESU-8.</span>
<span class='macro'>assert_eq</span><span class='macro'>!</span>(<span class='ident'>Cow</span>::<span class='ident'>Borrowed</span>(<span class='string'>&quot;a√©Êó•&quot;</span>.<span class='ident'>as_bytes</span>()),
           <span class='ident'>to_cesu8</span>(<span class='string'>&quot;a√©Êó•&quot;</span>));
<span class='macro'>assert_eq</span><span class='macro'>!</span>(<span class='ident'>Cow</span>::<span class='ident'>Borrowed</span>(<span class='string'>&quot;a√©Êó•&quot;</span>),
           <span class='ident'>from_cesu8</span>(<span class='string'>&quot;a√©Êó•&quot;</span>.<span class='ident'>as_bytes</span>()).<span class='ident'>unwrap</span>());

<span class='comment'>// This string is CESU-8 data containing a 6-byte surrogate pair,</span>
<span class='comment'>// which decodes to a 4-byte UTF-8 string.</span>
<span class='kw'>let</span> <span class='ident'>data</span> <span class='op'>=</span> <span class='kw-2'>&amp;</span>[<span class='number'>0xED</span>, <span class='number'>0xA0</span>, <span class='number'>0x81</span>, <span class='number'>0xED</span>, <span class='number'>0xB0</span>, <span class='number'>0x81</span>];
<span class='macro'>assert_eq</span><span class='macro'>!</span>(<span class='ident'>Cow</span>::<span class='ident'>Borrowed</span>(<span class='string'>&quot;\u{10401}&quot;</span>),
           <span class='ident'>from_cesu8</span>(<span class='ident'>data</span>).<span class='ident'>unwrap</span>());</pre>

<h3 id='a-note-about-security' class='section-header'><a href='#a-note-about-security'>A note about security</a></h3>
<p>As a general rule, this library is intended to fail on malformed or
unexpected input.  CESU-8 is supposed to be an internal-only format,
and if we&#39;re seeing malformed data, we assume that it&#39;s either a bug in
somebody&#39;s code, or an attacker is trying to improperly encode data to
evade security checks.</p>

<p>If you have a use case for lossy conversion to UTF-8, or conversion
from mixed UTF-8/CESU-8 data, please feel free to submit a pull request
for <code>from_cesu8_lossy_permissive</code> with appropriate behavior.</p>

<h3 id='java-and-u0000-and-other-variants' class='section-header'><a href='#java-and-u0000-and-other-variants'>Java and U+0000, and other variants</a></h3>
<p>Java uses the CESU-8 encoding as described above, but with one
difference: The null character U+0000 is represented as an overlong
UTF-8 sequence <code>C0 80</code>. This is supported by the <code>from_java_cesu8</code> and
<code>to_java_cesu8</code> methods.</p>

<h3 id='surrogate-pairs-and-utf-8' class='section-header'><a href='#surrogate-pairs-and-utf-8'>Surrogate pairs and UTF-8</a></h3>
<p>The UTF-16 encoding uses &quot;surrogate pairs&quot; to represent Unicode code
points in the range from U+10000 to U+10FFFF.  These are 16-bit numbers
in the range 0xD800 to 0xDFFF.</p>

<ul>
<li><p>0xD800 to 0xDBFF: First half of surrogate pair.  When encoded as
CESU-8, these become <strong>1110</strong>1101 <strong>10</strong>100000 <strong>10</strong>000000 to
<strong>1110</strong>1101 <strong>10</strong>101111 <strong>10</strong>111111.</p></li>
<li><p>0xDC00 to 0xDFFF: Second half of surrogate pair.  These become
<strong>1110</strong>1101 <strong>10</strong>110000 <strong>10</strong>000000 to
<strong>1110</strong>1101 <strong>10</strong>111111 <strong>10</strong>111111.</p></li>
</ul>

<p>Wikipedia <a href="http://en.wikipedia.org/wiki/UTF-16">explains</a> the
code point to UTF-16 conversion process:</p>

<blockquote>
<p>Consider the encoding of U+10437 (êê∑):</p>

<ul>
<li>Subtract 0x10000 from 0x10437. The result is 0x00437, 0000 0000 0100
0011 0111.</li>
<li>Split this into the high 10-bit value and the low 10-bit value:
0000000001 and 0000110111.</li>
<li>Add 0xD800 to the high value to form the high surrogate: 0xD800 +
0x0001 = 0xD801.</li>
<li>Add 0xDC00 to the low value to form the low surrogate: 0xDC00 +
0x0037 = 0xDC37.</li>
</ul>
</blockquote>
</div><h2 id='structs' class='section-header'><a href="#structs">Structs</a></h2>
<table>
                       <tr class=' module-item'>
                           <td><a class='struct' href='struct.Cesu8DecodingError.html'
                                  title='cesu8::Cesu8DecodingError'>Cesu8DecodingError</a></td>
                           <td class='docblock short'>
                                <p>The CESU-8 data could not be decoded as valid UTF-8 data.</p>
                           </td>
                       </tr></table><h2 id='functions' class='section-header'><a href="#functions">Functions</a></h2>
<table>
                       <tr class=' module-item'>
                           <td><a class='fn' href='fn.from_cesu8.html'
                                  title='cesu8::from_cesu8'>from_cesu8</a></td>
                           <td class='docblock short'>
                                <p>Convert CESU-8 data to a Rust string, re-encoding only if necessary.
Returns an error if the data cannot be represented as valid UTF-8.</p>
                           </td>
                       </tr>
                       <tr class=' module-item'>
                           <td><a class='fn' href='fn.from_java_cesu8.html'
                                  title='cesu8::from_java_cesu8'>from_java_cesu8</a></td>
                           <td class='docblock short'>
                                <p>Convert Java&#39;s modified UTF-8 data to a Rust string, re-encoding only if
necessary. Returns an error if the data cannot be represented as valid
UTF-8.</p>
                           </td>
                       </tr>
                       <tr class=' module-item'>
                           <td><a class='fn' href='fn.is_valid_cesu8.html'
                                  title='cesu8::is_valid_cesu8'>is_valid_cesu8</a></td>
                           <td class='docblock short'>
                                <p>Check whether a Rust string contains valid CESU-8 data.</p>
                           </td>
                       </tr>
                       <tr class=' module-item'>
                           <td><a class='fn' href='fn.is_valid_java_cesu8.html'
                                  title='cesu8::is_valid_java_cesu8'>is_valid_java_cesu8</a></td>
                           <td class='docblock short'>
                                <p>Check whether a Rust string contains valid Java&#39;s modified UTF-8 data.</p>
                           </td>
                       </tr>
                       <tr class=' module-item'>
                           <td><a class='fn' href='fn.to_cesu8.html'
                                  title='cesu8::to_cesu8'>to_cesu8</a></td>
                           <td class='docblock short'>
                                <p>Convert a Rust <code>&amp;str</code> to CESU-8 bytes.</p>
                           </td>
                       </tr>
                       <tr class=' module-item'>
                           <td><a class='fn' href='fn.to_java_cesu8.html'
                                  title='cesu8::to_java_cesu8'>to_java_cesu8</a></td>
                           <td class='docblock short'>
                                <p>Convert a Rust <code>&amp;str</code> to Java&#39;s modified UTF-8 bytes.</p>
                           </td>
                       </tr></table></section>
    <section id='search' class="content hidden"></section>

    <section class="footer"></section>

    <aside id="help" class="hidden">
        <div>
            <h1 class="hidden">Help</h1>

            <div class="shortcuts">
                <h2>Keyboard Shortcuts</h2>

                <dl>
                    <dt>?</dt>
                    <dd>Show this help dialog</dd>
                    <dt>S</dt>
                    <dd>Focus the search field</dd>
                    <dt>&larrb;</dt>
                    <dd>Move up in search results</dd>
                    <dt>&rarrb;</dt>
                    <dd>Move down in search results</dd>
                    <dt>&#9166;</dt>
                    <dd>Go to active search result</dd>
                </dl>
            </div>

            <div class="infos">
                <h2>Search Tricks</h2>

                <p>
                    Prefix searches with a type followed by a colon (e.g.
                    <code>fn:</code>) to restrict the search to a given type.
                </p>

                <p>
                    Accepted types are: <code>fn</code>, <code>mod</code>,
                    <code>struct</code>, <code>enum</code>,
                    <code>trait</code>, <code>type</code>, <code>macro</code>,
                    and <code>const</code>.
                </p>

                <p>
                    Search functions by type signature (e.g.
                    <code>vec -> usize</code> or <code>* -> vec</code>)
                </p>
            </div>
        </div>
    </aside>

    

    <script>
        window.rootPath = "../";
        window.currentCrate = "cesu8";
        window.playgroundUrl = "";
    </script>
    <script src="../jquery.js"></script>
    <script src="../main.js"></script>
    
    <script defer src="../search-index.js"></script>
</body>
</html>